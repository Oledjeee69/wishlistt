# Диагностика проблем с деплоем

## Если получаете 404 на всех эндпоинтах

### 1. Проверьте, что приложение запущено

Откройте в браузере:
- `https://<ваш-бэкенд>/health` - должно вернуть `{"status": "ok"}`
- `https://<ваш-бэкенд>/` - должно вернуть информацию об API
- `https://<ваш-бэкенд>/docs` - должна открыться Swagger документация
- `https://<ваш-бэкенд>/routes` - список всех доступных роутов

### 2. Проверьте структуру деплоя

**Если деплоите на Vercel:**
- Vercel ожидает файлы в папке `api/` для serverless функций
- Нужна специальная конфигурация (см. ниже)

**Если деплоите на Railway/Render/Fly.io:**
- Убедитесь, что `Dockerfile` правильно настроен
- Проверьте, что `CMD` в Dockerfile запускает `uvicorn app.main:app`
- Проверьте переменные окружения: `DATABASE_URL`, `SECRET_KEY`

### 3. Проверьте логи

В логах деплоя должны быть:
- Сообщения о запуске uvicorn
- НЕ должно быть ошибок импорта модулей
- НЕ должно быть ошибок подключения к БД (если они есть - проблема в `DATABASE_URL`)

### 4. Типичные проблемы

**Проблема:** Все запросы возвращают 404
**Решение:** 
- Проверьте, что роутеры подключены в `app/main.py`
- Проверьте, что путь запроса совпадает с путем в роутере (например, `/auth/login`, а не `/api/auth/login`)

**Проблема:** 500 Internal Server Error
**Решение:**
- Проверьте логи - там будет точная ошибка
- Чаще всего: не установлены зависимости (`email-validator`, `python-multipart`)
- Или не настроен `DATABASE_URL`

**Проблема:** CORS ошибки
**Решение:**
- Проверьте `cors_origins` в настройках
- Убедитесь, что домен фронтенда добавлен в разрешенные

### 5. Быстрая проверка

Выполните в терминале (замените URL на ваш):

```bash
# Проверка health
curl https://<ваш-бэкенд>/health

# Проверка списка роутов
curl https://<ваш-бэкенд>/routes

# Проверка Swagger
curl https://<ваш-бэкенд>/docs
```

Если все три запроса работают - приложение запущено правильно, проблема в путях запросов с фронтенда.
